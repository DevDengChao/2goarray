// Simple utility to convert a file into a Go byte array

// Clint Caywood

// http://github.com/cratonica/2goarray
package main

import (
	"fmt"
	"io"
	"os"
)

func main() {
	if len(os.Args) != 3 {
		fmt.Println("Usage: 2goarray array_name package_name")
		return
	}

	if isTerminal() {
		fmt.Println("\nPlease pipe the file you wish to encode into stdin\n")
		return
	}

	fmt.Println("// File generated by 2goarray (http://github.com/cratonica/2goarray)\n")
	fmt.Printf("package %s\n\n", os.Args[2])
	fmt.Printf("var %s []byte = []byte {", os.Args[1])
	buf := make([]byte, 1)
	var err error
	var totalBytes uint64
	var n int
	for n, err = os.Stdin.Read(buf); n > 0 && err == nil; {
		if totalBytes%12 == 0 {
			fmt.Printf("\n\t")
		}
		fmt.Printf("0x%02x, ", buf[0])
		totalBytes++
		n, err = os.Stdin.Read(buf)
	}
	if err != nil && err != io.EOF {
		fmt.Errorf("Error: %v", err)
	}
	fmt.Print("\n}\n\n")
}
